{"version":3,"sources":["Web Worlds Prefab/Assets/somSim.js","Web Worlds Prefab/Assets/_som_webWorld.js","Web Worlds Prefab/Assets/_testPlayer/Scripts/PlayerMovement.js","Web Worlds Prefab/Assets/_testPlayer/Scripts/CameraMovement.js","Web Worlds Prefab/Assets/_som_webBrowser.js","Web Worlds Prefab/Assets/_som_texScrollManager.js","Web Worlds Prefab/Assets/_som_videoTextureManager.js","Web Worlds Prefab/Assets/_som_remoteImageLoader.js"],"names":[],"mappings":"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","sourcesContent":["// somSim.js\nvar SomSim = pc.createScript('somSim');\n\nSomSim.prototype.initialize = function() {\n    var app = this.app;\n    if( app.hasOwnProperty('som') ) {\n        return;\n    }\n\n    app.som = this;\n    this.isSomnium = false;\n    this.player = null;\n    this.playerInputFrozen = false;\n};\n\nSomSim.prototype.postInitialize = function() {\n    if( this.app.som.isSomnium ) {\n        return;\n    }\n\n    this.player = this.entity.parent.findByName('LocalPlayerSimulator');\n    this.player.enabled = true;\n\n    var spawnpoints = this.app.root.children[0].findByTag(\"playerspawn\");\n    if( spawnpoints.length > 0 ) {\n        var spawnpoint = spawnpoints[Math.floor(Math.random()*spawnpoints.length)];\n        this.player.rigidbody.teleport(spawnpoint.getPosition().clone(), spawnpoint.getEulerAngles().clone());\n    }\n    setTimeout(function() {\n        this.app.som.fire('player:joinWorld');\n    }.bind(this), 1000);\n};\n\nSomSim.prototype.webWorldInit = function(worldConfig) {\n    return new Promise(function(resolve, reject) {\n        var entity = this.entity.findByName('Augment Platform Prefab');\n        entity.enabled = (worldConfig.type != 0);\n        resolve({\n            success: true\n        });\n    }.bind(this));\n};\n\nSomSim.prototype.setPlayerInputFrozen = function(val) {\n    this.playerInputFrozen = val;\n};\n\n","// _som_webWorld.js\nvar SomWebWorld = pc.createScript('_som_webWorld');\nSomWebWorld.attributes.add('type', {\n    title: 'World Type',\n    description: 'Control how visitors load into your world. Augment Worlds get ADDED to the regular parcel build. Holistic Worlds REPLACE the regular parcel build.',\n    type: 'number',\n    enum: [\n        { 'Holistic World': 0 },\n        { 'Augment World': 1 }\n    ],\n    default: 0\n});\n\nSomWebWorld.attributes.add('allowedParcels', {\n    title: 'Allowed Parcels',\n    type: 'number',\n    array: true,\n    description: 'Explicitly list which PARCEL IDs that Somnium Space Web is allowed to use this world on. Leave blank to allow ANY parcel to use this world.'\n});\n\nSomWebWorld.attributes.add('sdkVersion', {\n    title: 'SDK Version',\n    type: 'number',\n    enum: [\n        { 'v0-1-2': 2 }\n    ],\n    default: 2\n});\n\nSomWebWorld.prototype.postInitialize = function() {\n    var worldConfig = {\n        id: this.id,\n        title: this.title,\n        url: this.url,\n        type: this.type,\n        allowEverywhere: this.allowEverywhere,\n        allowedParcels: this.allowedParcels,\n        worldMixing: this.worldMixing,\n        mixWorlds: this.mixWorlds,\n        apiVersion: this.apiVersion\n    };\n\n    var entities;\n    if( !this.app.som.isSomnium ) {\n        entities = this.app.root.children[0].findByTag('disableIfNotSom');\n        for( var i = 0; i < entities.length; i++ ) {\n            entities[i].enabled = false;\n        }\n        entities = this.app.root.children[0].findByTag('enableIfNotSom');\n        for( var i = 0; i < entities.length; i++ ) {\n            entities[i].enabled = true;\n        }\n    }\n    else {\n        entities = this.app.root.children[0].findByTag('disableIfSom');\n        for( var i = 0; i < entities.length; i++ ) {\n            entities[i].enabled = false;\n        }\n        entities = this.app.root.children[0].findByTag('enableIfSom');\n        for( var i = 0; i < entities.length; i++ ) {\n            entities[i].enabled = true;\n        }\n    }\n    \n    this.app.som.webWorldInit(worldConfig).then((response) => {\n        if( response.success ) {\n            console.log('Web World Initialized');\n        }\n        else {\n            console.log(response.errorMessage);\n        }\n    });\n};\n\n","// PlayerMovement.js\nvar PlayerMovement = pc.createScript('playerMovement');\n\nPlayerMovement.attributes.add('speed', { type: 'number', default: 0.09 });\n\nPlayerMovement.prototype.initialize = function () {\n    var app = this.app;\n    var camera = app.root.findByName('Camera');\n    this.cameraScript = camera.script.cameraMovement;    \n};\n\n\n// Temp variable to avoid garbarge colleciton\nPlayerMovement.worldDirection = new pc.Vec3();\nPlayerMovement.tempDirection = new pc.Vec3();\n\nPlayerMovement.prototype.update = function (dt) {\n    var app = this.app;\n    var worldDirection = PlayerMovement.worldDirection;\n    worldDirection.set(0, 0, 0);\n    \n    var tempDirection = PlayerMovement.tempDirection;\n    \n    var forward = this.entity.forward;\n    var right = this.entity.right;\n\n    var x = 0;\n    var z = 0; \n    \n    if( !this.app.som.playerInputFrozen ) {\n        if (app.keyboard.isPressed(pc.KEY_A)) {\n            x -= 1;\n        }\n\n        if (app.keyboard.isPressed(pc.KEY_D)) {\n            x += 1;\n        }\n\n        if (app.keyboard.isPressed(pc.KEY_W)) {\n            z += 1;\n        }\n\n        if (app.keyboard.isPressed(pc.KEY_S)) {\n            z -= 1;\n        }\n\n        if (x !== 0 || z !== 0) {\n            worldDirection.add(tempDirection.copy(forward).mulScalar(z));\n            worldDirection.add(tempDirection.copy(right).mulScalar(x));        \n            worldDirection.normalize();\n            \n            var pos = new pc.Vec3(worldDirection.x * dt, 0, worldDirection.z * dt);\n            pos.normalize().scale(this.speed);\n            pos.add(this.entity.getPosition());\n\n            var targetY = this.cameraScript.eulers.x + 180;\n            var rot = new pc.Vec3(0, targetY, 0);\n\n            this.entity.rigidbody.teleport(pos, rot);\n        }\n    }\n\n    this.entity.anim.setFloat('xDirection', x);\n    this.entity.anim.setFloat('zDirection', z);\n};\n\n","// CameraMovement.js\nvar CameraMovement = pc.createScript('cameraMovement');\n\nCameraMovement.attributes.add('mouseSpeed', { type: 'number', default: 1.4, description: 'Mouse Sensitivity' });\n\n// Called once after all resources are loaded and before the first update\nCameraMovement.prototype.initialize = function () {\n    this.eulers = new pc.Vec3();\n    this.touchCoords = new pc.Vec2();\n\n    this.cameraInputDown = false;\n\n    var app = this.app;\n    app.mouse.on(\"mousemove\", this.onMouseMove, this);\n    app.mouse.on(\"mousedown\", this.onMouseDown, this);\n    app.mouse.on(\"mouseup\", this.onMouseUp, this);\n\n    this.rayEnd = app.root.findByName('RaycastEndPoint');\n    \n    this.on('destroy', function() {\n        app.mouse.off(\"mousemove\", this.onMouseMove, this);\n        app.mouse.off(\"mousedown\", this.onMouseDown, this);\n        app.mouse.off(\"mouseup\", this.onMouseUp, this);\n    }, this);\n};\n    \nCameraMovement.prototype.postUpdate = function (dt) {\n    if( this.app.som.playerInputFrozen ) {\n        return;\n    }\n\n    var originEntity = this.entity.parent;\n    \n    var targetY = this.eulers.x + 180;\n    var targetX = this.eulers.y;\n\n    var targetAng = new pc.Vec3(-targetX, targetY, 0);\n    \n    originEntity.setEulerAngles(targetAng);\n                   \n    this.entity.setPosition(this.getWorldPoint());\n    \n    this.entity.lookAt(originEntity.getPosition());\n};\n\nCameraMovement.prototype.onMouseMove = function (e) {\n    if( this.app.som.playerInputFrozen ) {\n        return;\n    }\n\n    if (pc.Mouse.isPointerLocked()) {\n        this.eulers.x -= ((this.mouseSpeed * e.dx) / 60) % 360;\n        this.eulers.y += ((this.mouseSpeed * e.dy) / 60) % 360;\n\n        if (this.eulers.x < 0) this.eulers.x += 360;\n        if (this.eulers.y < 0) this.eulers.y += 360;\n    }\n    else if( this.cameraInputDown ) {\n        this.eulers.x -= ((this.mouseSpeed * e.dx) / 60) % 360;\n        this.eulers.y += ((this.mouseSpeed * e.dy) / 60) % 360;\n\n        if (this.eulers.x < 0) this.eulers.x += 360;\n        if (this.eulers.y < 0) this.eulers.y += 360;\n    }\n};\n\nCameraMovement.prototype.onMouseDown = function (e) {\n    if( this.app.som.playerInputFrozen ) {\n        return;\n    }\n\n    this.cameraInputDown = true;\n};\n\nCameraMovement.prototype.onMouseUp = function (e) {\n    if( this.app.som.playerInputFrozen ) {\n        return;\n    }\n    \n    this.cameraInputDown = false;\n};\n\nCameraMovement.prototype.getWorldPoint = function () {\n    var from = this.entity.parent.getPosition(); \n    var to = this.rayEnd.getPosition();\n\n    var hitPoint = to;\n\n    var app = this.app;\n    var hit = app.systems.rigidbody.raycastFirst(from, to);\n    \n    return hit ? hit.point : to;\n};\n\n\n","// _som_webBrowser.js\nvar SomWebBrowser = pc.createScript('_som_webBrowser');\nSomWebBrowser.attributes.add('url', {\n    type: 'string',\n    title: 'URL',\n    description: \"URL to bind to this entity's model.\"\n});\nSomWebBrowser.attributes.add('resolution', {\n    type: 'number',\n    title: 'Resolution',\n    enum: [\n        { 'Auto': 0 },\n        { 'Low': 1 },\n        { 'Medium': 2 },\n        { 'High': 3 }\n    ],\n    default: 0,\n    description: \"Control the resolution scale of the web browser object.\"\n});\nSomWebBrowser.attributes.add('autoPlay', {\n    type: 'boolean',\n    title: 'AutoPlay',\n    default: false,\n    description: 'Automatically activates this web browser object upon spawning into the world.'\n});\nSomWebBrowser.attributes.add('description', {\n    type: 'string',\n    title: 'UI Text',\n    description: \"Optional. The text to show on the menu when the user clicks on the object.\"\n});\nSomWebBrowser.attributes.add('thumbnail', {\n    type: 'asset',\n    title: 'UI Thumbnail',\n    assetType: 'texture',\n    description: \"Appears in the menu when the user clicks on the object.\"\n});\nSomWebBrowser.attributes.add('buttonGo', {\n    type: 'boolean',\n    title: 'UI Btn Go',\n    default: false,\n    description: 'Opens link in same window.'\n});\nSomWebBrowser.attributes.add('buttonNewTab', {\n    type: 'boolean',\n    title: 'UI Btn New Tab',\n    default: true,\n    description: 'Opens link in new window.'\n});\nSomWebBrowser.attributes.add('buttonInWorld', {\n    type: 'boolean',\n    title: 'UI Btn In-World',\n    default: true,\n    description: 'Opens link in-world.'\n});\nSomWebBrowser.prototype.initialize = function() {\n};\n\n","// _som_texScrollManager.js\nvar SomTexScrollManager = pc.createScript('_som_texScrollManager');\nSomTexScrollManager.attributes.add('materials', {\n    title: 'Materials to Scroll',\n    type: 'json',\n    schema: [{\n        title: 'Material Asset',\n        name: 'material',\n        type: 'asset',\n        assetType: 'material'\n    }, {\n        title: 'Speed',\n        name: 'speed',\n        type: 'vec2'\n    }, {\n        title: 'Diffuse',\n        name: 'diffuse',\n        type: 'boolean',\n        default: true\n    }, {\n        title: 'Normal',\n        name: 'normal',\n        type: 'boolean',\n        default: false\n    }, {\n        title: 'Emissive',\n        name: 'emissive',\n        type: 'boolean',\n        default: false\n    }, {\n        title: 'Opacity',\n        name: 'opacity',\n        type: 'boolean',\n        default: false\n    }],\n    array: true\n});\nSomTexScrollManager.tmpVec2 = new pc.Vec2();\nSomTexScrollManager.tmpOffset = new pc.Vec2();\nSomTexScrollManager.prototype.initialize = function() {};\nSomTexScrollManager.prototype.update = function(dt) {\n    let velocity = SomTexScrollManager.tmpVec2;\n    let offset = SomTexScrollManager.tmpOffset;\n    let materialEntry, material;\n    let shaderNames, j, shaderName, changed;\n    for( let i = 0; i < this.materials.length; i++ ) {\n        materialEntry = this.materials[i];\n        material = (materialEntry.material && materialEntry.material.resource) ? materialEntry.material.resource : null;\n        if( material ) {\n            velocity.set(materialEntry.speed.x, materialEntry.speed.y);\n            velocity.scale(dt);\n            shaderNames = [];\n            if( materialEntry.diffuse ) {\n                shaderNames.push('diffuseMapOffset');\n            }\n            if( materialEntry.normal ) {\n                shaderNames.push('normalMapOffset');\n            }\n            if( materialEntry.emissive ) {\n                shaderNames.push('emissiveMapOffset');\n            }\n            if( materialEntry.opacity ) {\n                shaderNames.push('opacityMapOffset');\n            }\n            changed = false;\n            for( j = 0; j < shaderNames.length; j++ ) {\n                shaderName = shaderNames[j];\n                if( material[shaderName] ) {\n                    offset.copy(material[shaderName]);\n                    offset.add(velocity);\n                    material[shaderName] = offset;\n                    changed = true;\n                }\n            }\n            if( changed ) {\n                material.update();\n            }\n        }\n    }\n};\n\n","// _som_videoTextureManager.js\nvar SomVideoTextureManager = pc.createScript('_som_videoTextureManager');\nSomVideoTextureManager.attributes.add('throttle', {\n    title: 'Optimize Performance',\n    type: 'boolean',\n    description: 'When enabled, no more than 1 video texture will update per-engine-frame.',\n    default: true\n});\nSomVideoTextureManager.attributes.add('videos', {\n    title: 'Videos',\n    type: 'json',\n    schema: [{\n        title: 'Material Asset',\n        name: 'material',\n        type: 'asset',\n        assetType: 'material'\n    }, {\n        title: 'Video Asset',\n        name: 'asset',\n        type: 'asset',\n        description: 'Use an MP4 video asset OR a URL, not both.'\n    }, {\n        title: 'Video URL',\n        name: 'url',\n        type: 'string',\n        description: 'Use an MP4 video asset OR a URL, not both.'\n    }, {\n        title: 'Diffuse',\n        name: 'diffuse',\n        type: 'boolean',\n        default: false\n    }, {\n        title: 'Emissive',\n        name: 'emissive',\n        type: 'boolean',\n        default: true\n    }],\n    array: true\n});\nSomVideoTextureManager.prototype.initialize = function() {\n    const app = this.app;\n    const self = this;\n    this.updateIndex = -1;\n    this.runningVideos = [];\n    for( let i = 0; i < this.videos.length; i++ ) {\n        let videoEntry = this.videos[i];\n        let runningVideo = {};\n\n        // create element\n        var video = document.createElement('video');\n        video.loop = true;\n        video.muted = true;\n        video.playsInline = true;   // for iOS\n        video.crossOrigin = 'anonymous';\n        video.autoplay = true;\n        video.style.cssText = 'width: 1px; height: 1px; position: absolute; opacity: 0; z-index: -1000; pointer-events: none;';   // for iOS\n        document.body.appendChild(video);\n\n        // create a texture\n        let texture = new pc.Texture(app.graphicsDevice, {\n            format: pc.PIXELFORMAT_R8_G8_B8,\n            minFilter: pc.FILTER_LINEAR_MIPMAP_LINEAR,\n            magFilter: pc.FILTER_LINEAR,\n            addressU: pc.ADDRESS_CLAMP_TO_EDGE,\n            addressV: pc.ADDRESS_CLAMP_TO_EDGE,\n            mipmaps: true\n        });\n        texture.setSource(video);\n\n        // autoplay\n        video.addEventListener('canplaythrough', function (e) {\n            if( this.entry.emissive ) {\n                this.entry.material.resource.emissiveMap = this.texture;\n            }\n            if( this.entry.diffuse ) {\n                this.entry.material.resource.diffuseMap = this.texture;\n            }\n            this.entry.material.resource.update();\n            video.play();\n        }.bind(runningVideo));\n\n        // set video source\n        video.src = videoEntry.asset ? videoEntry.asset.getFileUrl() : videoEntry.url;\n        document.body.appendChild(video);\n        video.load();\n\n        runningVideo.entry = videoEntry;\n        runningVideo.video = video;\n        runningVideo.texture = texture;\n        this.runningVideos.push(runningVideo);\n    }\n};\nSomVideoTextureManager.prototype.update = function(dt) {\n    if( this.runningVideos.length > 0 ) {\n        if( this.throttle ) {\n            this.updateIndex++;\n            if( this.updateIndex >= this.runningVideos.length ) {\n                this.updateIndex = 0;\n            }\n            let runningVideo = this.runningVideos[this.updateIndex];\n            let video = runningVideo.video;\n            const isVideoPlaying = video => !!(video.currentTime > 0 && !video.paused && !video.ended && video.readyState > 2);\n            if( isVideoPlaying ) {\n                runningVideo.texture.upload();\n            }\n        }\n        else {\n            for( let i = 0; i < this.runningVideos.length; i++ ) {\n                let runningVideo = this.runningVideos[i];\n                let video = runningVideo.video;\n                const isVideoPlaying = video => !!(video.currentTime > 0 && !video.paused && !video.ended && video.readyState > 2);\n                if( isVideoPlaying ) {\n                    runningVideo.texture.upload();\n                }\n            }\n        }\n    }\n};\n\n","// _som_remoteImageLoader.js\nvar SomRemoteImageLoader = pc.createScript('_som_remoteImageLoader');\nSomRemoteImageLoader.attributes.add('images', {\n    title: 'Images',\n    type: 'json',\n    schema: [{\n        title: 'Material Asset',\n        name: 'material',\n        type: 'asset',\n        assetType: 'material'\n    }, {\n        title: 'Image URL',\n        name: 'url',\n        type: 'string'\n    }, {\n        title: 'Diffuse',\n        name: 'diffuse',\n        type: 'boolean',\n        default: true\n    }, {\n        title: 'Emissive',\n        name: 'emissive',\n        type: 'boolean',\n        default: true\n    }, {\n        title: 'Use Transparency',\n        name: 'transparent',\n        type: 'boolean',\n        default: false\n    }],\n    array: true\n});\nSomRemoteImageLoader.prototype.initialize = function() {\n    let imageEntry;\n    let app = this.app;\n    let self = this;\n    for( let i = 0; i < this.images.length; i++ ) {\n        imageEntry = this.images[i];\n        if( !imageEntry.url ) {\n            continue;\n        }\n        \n        this.app.loader.getHandler('texture').crossOrigin = 'anonymous';\n        let asset = new pc.Asset('remoteTexture', 'texture', {\n            url: imageEntry.url\n        });\n        this.app.assets.add(asset);\n        asset.on('error', function (message) {\n            console.log(message);\n        });\n        asset.on('load', function (asset) {\n            if( this.emissive ) {\n                this.material.resource.emissiveMap = asset.resource;\n            }\n            if( this.diffuse ) {\n                this.material.resource.diffuseMap = asset.resource;\n            }\n            if( this.transparent ) {\n                this.material.resource.blendType = pc.BLEND_NORMAL;\n                this.material.resource.opacityMapChannel = 'a';\n                this.material.resource.opacityMap = asset.resource;\n            }\n            this.material.resource.update();\n        }.bind(imageEntry));\n        this.app.assets.load(asset);\n    }\n};\n\n"]}